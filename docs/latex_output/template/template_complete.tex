\documentclass[12pt,a4paper,oneside]{report}
\usepackage[utf8]{inputenc}
\usepackage[spanish,english]{babel}
\renewcommand{\chaptername}{Capítulo}
\usepackage[margin=2.5cm,top=3cm,bottom=3cm]{geometry}
\usepackage{fancyhdr}
\usepackage{graphicx}
\usepackage{hyperref}
\usepackage{listings}
\usepackage{xcolor}
\usepackage{tocloft}
\usepackage{titlesec}
\usepackage{longtable}
\usepackage{booktabs}
\usepackage{array}
\usepackage{multirow}
\usepackage{calc}
\usepackage{float}
\usepackage{setspace}
\usepackage{parskip}

% Definir tightlist si no existe
\providecommand{\tightlist}{%
  \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}

% Definir pandocbounded si no existe
\providecommand{\pandocbounded}[1]{#1}

% Definir passthrough si no existe
\providecommand{\passthrough}[1]{\texttt{#1}}

% Configuración de spacing
\onehalfspacing
\setlength{\parskip}{6pt}

% Configuración de imágenes para ajuste automático
\usepackage{adjustbox}
\graphicspath{{processed/images/}}
\setkeys{Gin}{width=\linewidth,height=\textheight,keepaspectratio}

% Configuración de colores para código
\definecolor{codegreen}{rgb}{0,0.6,0}
\definecolor{codegray}{rgb}{0.5,0.5,0.5}
\definecolor{codepurple}{rgb}{0.58,0,0.82}
\definecolor{backcolour}{rgb}{0.95,0.95,0.92}

% Configuración de listings
\lstdefinestyle{mystyle}{
    backgroundcolor=\color{backcolour},   
    commentstyle=\color{codegreen},
    keywordstyle=\color{magenta},
    numberstyle=\tiny\color{codegray},
    stringstyle=\color{codepurple},
    basicstyle=\ttfamily\footnotesize,
    breakatwhitespace=false,         
    breaklines=true,                 
    captionpos=b,                    
    keepspaces=true,                 
    numbers=left,                    
    numbersep=5pt,                  
    showspaces=false,                
    showstringspaces=false,
    showtabs=false,                  
    tabsize=2
}
\lstset{style=mystyle}

% Headers y footers
\pagestyle{fancy}
\fancyhf{}
\fancyhead[R]{\small\leftmark}
\fancyfoot[C]{\thepage}

% Configurar marks para mostrar nombres de capítulos correctamente
\renewcommand{\chaptermark}[1]{\markboth{#1}{}}

% Configuración de títulos
\titleformat{\chapter}[hang]
{\normalfont\huge\bfseries}{\thechapter.}{1em}{}
\titlespacing*{\chapter}{0pt}{0pt}{20pt}

% Configuración de hyperlinks
\hypersetup{
    colorlinks=true,
    linkcolor=blue,
    filecolor=magenta,      
    urlcolor=cyan,
    citecolor=red,
    pdftitle={Plataforma de Gestión de TFG - Documentación Técnica},
    pdfauthor={Tu Nombre},
    pdfsubject={Trabajo de Fin de Grado - Ingeniería Informática},
    pdfcreator={Pandoc with LaTeX},
    pdfkeywords={TFG, React, Symfony, Plataforma Web}
}

% Configuración de tabla de contenidos
\setcounter{tocdepth}{3}
\setcounter{secnumdepth}{3}

% Redefinir el comando de inclusión de imágenes de Pandoc
\makeatletter
\def\maxwidth{\ifdim\Gin@nat@width>\linewidth\linewidth\else\Gin@nat@width\fi}
\def\maxheight{\ifdim\Gin@nat@height>0.8\textheight 0.8\textheight\else\Gin@nat@height\fi}
\makeatother
\setkeys{Gin}{width=\maxwidth,height=\maxheight,keepaspectratio}

\begin{document}

% Incluir portada
\input{template/portada.tex}

% Tabla de contenidos
\renewcommand{\contentsname}{Índice}
\markboth{Índice}{Índice}
\tableofcontents
\newpage

% Lista de figuras
\renewcommand{\listfigurename}{Lista de Figuras}
\markboth{Lista de Figuras}{Lista de Figuras}
\listoffigures
\newpage

% Limpiar marks antes del contenido principal
\markboth{}{}

% Configurar numeración de capítulos
\setcounter{chapter}{0}

% Contenido principal
$body$

% Bibliografía (si existe)
\bibliographystyle{plain}
\bibliography{referencias}

\end{document}